
name: Upload coverage
runs-on: ubuntu-latest
needs: test
if: success()
permissions:
  contents: read
steps:
  - name: Checkout code
    uses: actions/checkout@v4
  - name: Download all coverage artifacts
    uses: actions/download-artifact@v4
    with:
      path: coverage_artifacts
  - name: Upload coverage to Codecov
    uses: codecov/codecov-action@v5
    with:
      directory: coverage_artifacts
      token: ${{ secrets.CODECOV_TOKEN }}
      fail_ci_if_error: true
      verbose: true