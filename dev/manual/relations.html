<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Entity relationships · Ark.jl</title><meta name="title" content="Entity relationships · Ark.jl"/><meta property="og:title" content="Entity relationships · Ark.jl"/><meta property="twitter:title" content="Entity relationships · Ark.jl"/><meta name="description" content="Ark.jl is an archetype-based Entity Component System (ECS) for Julia."/><meta property="og:description" content="Ark.jl is an archetype-based Entity Component System (ECS) for Julia."/><meta property="twitter:description" content="Ark.jl is an archetype-based Entity Component System (ECS) for Julia."/><meta property="og:url" content="https://ark-ecs.github.io/Ark.jl/stable/manual/relations.html"/><meta property="twitter:url" content="https://ark-ecs.github.io/Ark.jl/stable/manual/relations.html"/><link rel="canonical" href="https://ark-ecs.github.io/Ark.jl/stable/manual/relations.html"/><meta property="og:image" content="https://ark-ecs.github.io/Ark.jl/stable/assets/preview.png"/><meta property="twitter:image" content="https://ark-ecs.github.io/Ark.jl/stable/assets/preview.png"/><meta property="twitter:card" content="summary_large_image"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/><link href="../assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../index.html"><img class="docs-light-only" src="../assets/logo.svg" alt="Ark.jl logo"/><img class="docs-dark-only" src="../assets/logo-dark.svg" alt="Ark.jl logo"/></a><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="quickstart.html">Quickstart</a></li><li><a class="tocitem" href="world.html">The World</a></li><li><a class="tocitem" href="entities.html">Entities</a></li><li><a class="tocitem" href="components.html">Components</a></li><li><a class="tocitem" href="queries.html">Queries</a></li><li><a class="tocitem" href="systems.html">Systems</a></li><li><a class="tocitem" href="resources.html">Resources</a></li><li class="is-active"><a class="tocitem" href="relations.html">Entity relationships</a><ul class="internal"><li><a class="tocitem" href="#Relation-components"><span>Relation components</span></a></li><li><a class="tocitem" href="#Creating-relations"><span>Creating relations</span></a></li><li><a class="tocitem" href="#Get-and-set-relations"><span>Get and set relations</span></a></li><li><a class="tocitem" href="#Querying-relations"><span>Querying relations</span></a></li><li><a class="tocitem" href="#Dead-target-entities"><span>Dead target entities</span></a></li><li><a class="tocitem" href="#Limitations"><span>Limitations</span></a></li><li><a class="tocitem" href="#When-to-use,-and-when-not"><span>When to use, and when not</span></a></li></ul></li><li><a class="tocitem" href="batch.html">Batch operations</a></li><li><a class="tocitem" href="events.html">Event system</a></li><li><a class="tocitem" href="architecture.html">Architecture</a></li></ul></li><li><a class="tocitem" href="../demos.html">Demos</a></li><li><a class="tocitem" href="../benchmarks.html">Benchmarks</a></li><li><a class="tocitem" href="../api.html">Public API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href="relations.html">Entity relationships</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="relations.html">Entity relationships</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ark-ecs/Ark.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/ark-ecs/Ark.jl/blob/main/docs/src/manual/relations.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Entity-relationships"><a class="docs-heading-anchor" href="#Entity-relationships">Entity relationships</a><a id="Entity-relationships-1"></a><a class="docs-heading-anchor-permalink" href="#Entity-relationships" title="Permalink"></a></h1><p>In a basic ECS, relations between entities, like hierarchies, can be represented by storing entities in components. E.g., we could have a child component like this:</p><pre><code class="language-julia hljs">struct ChildOf
    parent::Entity
end</code></pre><p>Or, alternatively, a parent component with many children:</p><pre><code class="language-julia hljs">struct Parent
    children::Vector{Entity}
end</code></pre><p>This may be sufficient for many use cases. However, we are not able to leverage the power of queries to e.g. get all children of a particular parent in an efficient way.</p><p>To make entity relations even more useful and efficient, Ark.jl supports them as a first class feature. Relations are added to and removed from entities just like components, and hence can be queried like components, with the usual efficiency. This is achieved by creating separate sub-tables inside <a href="architecture.html#Architecture">archetypes</a> for relations with different target entities.</p><h2 id="Relation-components"><a class="docs-heading-anchor" href="#Relation-components">Relation components</a><a id="Relation-components-1"></a><a class="docs-heading-anchor-permalink" href="#Relation-components" title="Permalink"></a></h2><p>To use entity relations, create components that are sub-types of the abstract marker type <a href="../api.html#Ark.Relationship">Relationship</a>:</p><pre><code class="language-julia hljs">struct ChildOf &lt;: Relationship
end</code></pre><p>That&#39;s all to make a component be treated as an entity relationship by Ark. Relation components can contain variables/fields like usual components, but in many cases they will just be empty structs.</p><h2 id="Creating-relations"><a class="docs-heading-anchor" href="#Creating-relations">Creating relations</a><a id="Creating-relations-1"></a><a class="docs-heading-anchor-permalink" href="#Creating-relations" title="Permalink"></a></h2><p>All functions that create or add components take a keyword argument <code>relations</code> that allows to specify target entities for relationship components using tuples of <code>Type =&gt; Entity</code> pairs.</p><h3 id="On-new-entities"><a class="docs-heading-anchor" href="#On-new-entities">On new entities</a><a id="On-new-entities-1"></a><a class="docs-heading-anchor-permalink" href="#On-new-entities" title="Permalink"></a></h3><p>To create an entity with relations, add a relationship component and specify it&#39;s target entity using <a href="../api.html#Ark.new_entity!">new_entity!</a>:</p><pre><code class="language-julia hljs">entity = new_entity!(world, 
                     (Position(0, 0), ChildOf());
                     relations=(ChildOf =&gt; parent,))</code></pre><p>This works in the same way for batch entity creation with <a href="../api.html#Ark.new_entities!">new_entities!</a>.</p><p>Multiple relationships can be used in a similar way:</p><pre><code class="language-julia hljs">entity = new_entity!(world, 
                     (Position(0, 0), ChildOf(), RenderLayer());
                     relations=(ChildOf =&gt; parent, RenderLayer =&gt; layer1))</code></pre><p>Note that, when creating entities with relationship components, targets for all relations must be specified.</p><h3 id="When-adding-components"><a class="docs-heading-anchor" href="#When-adding-components">When adding components</a><a id="When-adding-components-1"></a><a class="docs-heading-anchor-permalink" href="#When-adding-components" title="Permalink"></a></h3><p>Relation target must also be given when adding relation components to an entity with <a href="../api.html#Ark.add_components!">add_components!</a>:</p><pre><code class="language-julia hljs">add_components!(world, entity, (ChildOf(),); relations=(ChildOf =&gt; parent,))</code></pre><p>The same applies for <a href="../api.html#Ark.exchange_components!">exchange_components!</a>,</p><h2 id="Get-and-set-relations"><a class="docs-heading-anchor" href="#Get-and-set-relations">Get and set relations</a><a id="Get-and-set-relations-1"></a><a class="docs-heading-anchor-permalink" href="#Get-and-set-relations" title="Permalink"></a></h2><p>We can also change the target entity of an already assigned relation component. This is done via <a href="../api.html#Ark.set_relations!">set_relations!</a>:</p><pre><code class="language-julia hljs">entity = new_entity!(world, 
                     (Position(0, 0), ChildOf());
                     relations=(ChildOf =&gt; parent,))

set_relations!(world, entity, (ChildOf =&gt; parent2,))</code></pre><p>This also works for changing the targets of multiple relations in one function call.</p><p>Target entities can be retrieved with <a href="../api.html#Ark.get_relations">get_relations</a>:</p><pre><code class="language-julia hljs">entity = new_entity!(world, 
                     (Position(0, 0), ChildOf());
                     relations=(ChildOf =&gt; parent,))

parent_entity, = get_relations(world, entity, (ChildOf,))</code></pre><p>Note that <a href="../api.html#Ark.get_relations">get_relations</a> always returns a tuple of entities.</p><p>As with other operations, relation targets can be set in batches. See chapter <a href="batch.html#Batch-operations">Batch operations</a> for details.</p><h2 id="Querying-relations"><a class="docs-heading-anchor" href="#Querying-relations">Querying relations</a><a id="Querying-relations-1"></a><a class="docs-heading-anchor-permalink" href="#Querying-relations" title="Permalink"></a></h2><p>Queries support filtering for relation targets using the keyword argument <code>relations</code> in the same way as already shown:</p><pre><code class="language-julia hljs">for (entities, children) in Query(world, (ChildOf,); relations=(ChildOf =&gt; parent,))
    # ...
end</code></pre><p>In many use cases, relation components don&#39;t contain any data. Here, component values are not required in the query iteration. It is thus sufficient to have the relation component in the query&#39;s <code>with</code>:</p><pre><code class="language-julia hljs">for (entities,) in Query(world, (); with=(ChildOf,), relations=(ChildOf =&gt; parent,))
    # ...
end</code></pre><p>Note that when querying for relations without specifying target entities, entities for all targets will be included in the iteration. Similarly, if the targets for some of multiple relations of an entity are not specified, these are treated as wildcards.</p><h2 id="Dead-target-entities"><a class="docs-heading-anchor" href="#Dead-target-entities">Dead target entities</a><a id="Dead-target-entities-1"></a><a class="docs-heading-anchor-permalink" href="#Dead-target-entities" title="Permalink"></a></h2><p>Entities that are the target of any relationships can be removed from the world like any other entity. When this happens, all entities that have this target in a relation get assigned to the zero entity as target. The respective <a href="architecture.html#Architecture">archetype</a> sub-table is de-activated and marked for potential re-use for another target entity.</p><h2 id="Limitations"><a class="docs-heading-anchor" href="#Limitations">Limitations</a><a id="Limitations-1"></a><a class="docs-heading-anchor-permalink" href="#Limitations" title="Permalink"></a></h2><p>Unlike <a href="https://flecs.dev">Flecs</a>, the ECS that pioneered entity relationships, Ark is limited to supporting only &quot;exclusive&quot; relationships. This means that any relationship (i.e. relationship type/component) can only have a single target entity. An entity can, however, have multiple different relationship types at the same time.</p><p>The limitation to a single target is mainly a performance consideration. Firstly, the possibility for multiple targets would require a different, slower approach for component mapping in archetypes. Secondly, usage of multiple targets would easily lead to archetype fragmentation, as a separate archetype sub-table would be created for each unique combination of targets.</p><p>Entity relationships in Ark are still a very powerful feature, while discouraging use cases where they could easily lead to poor performance. For more details on when entity relationships are the most effective and efficient, see the next section.</p><h2 id="When-to-use,-and-when-not"><a class="docs-heading-anchor" href="#When-to-use,-and-when-not">When to use, and when not</a><a id="When-to-use,-and-when-not-1"></a><a class="docs-heading-anchor-permalink" href="#When-to-use,-and-when-not" title="Permalink"></a></h2><p>When using Ark&#39;s entity relations, an archetype sub-table is created for each target entity of a relation. Thus, entity relations are not efficient if the number of target entities is high (tens of thousands), while only a low number of entities has a relation to each particular target (less than a few dozens). Particularly in the extreme case of 1:1 relations, storing entities in components as explained in the introduction of this chapter is more efficient.</p><p>However, with a moderate number of relation targets, particularly with many entities per target, entity relations are very efficient.</p><p>Beyond use cases where the relation target is a &quot;physical&quot; entity that appears in a simulation or game, targets can also be more abstract, like categories. Examples:</p><ul><li>Different tree species in a forest model.</li><li>Behavioral states in a finite state machine.</li><li>The opposing factions in a strategy game.</li><li>Render layers in a game or other graphical application.</li></ul><p>This concept is particularly useful for things that would best be expressed by components, but the possible components (or categories) are only known at runtime. Thus, it is not possible to create ordinary components for them. However, these categories can be represented by entities, which are used as relation targets.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="resources.html">« Resources</a><a class="docs-footer-nextpage" href="batch.html">Batch operations »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Saturday 27 December 2025 23:06">Saturday 27 December 2025</span>. Using Julia version 1.12.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
