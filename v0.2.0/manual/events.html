<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Event system · Ark.jl</title><meta name="title" content="Event system · Ark.jl"/><meta property="og:title" content="Event system · Ark.jl"/><meta property="twitter:title" content="Event system · Ark.jl"/><meta name="description" content="Ark.jl is an archetype-based Entity Component System (ECS) for Julia."/><meta property="og:description" content="Ark.jl is an archetype-based Entity Component System (ECS) for Julia."/><meta property="twitter:description" content="Ark.jl is an archetype-based Entity Component System (ECS) for Julia."/><meta property="og:url" content="https://mlange-42.github.io/Ark.jl/stable/manual/events.html"/><meta property="twitter:url" content="https://mlange-42.github.io/Ark.jl/stable/manual/events.html"/><link rel="canonical" href="https://mlange-42.github.io/Ark.jl/stable/manual/events.html"/><meta property="og:image" content="https://mlange-42.github.io/Ark.jl/stable/assets/preview.png"/><meta property="twitter:image" content="https://mlange-42.github.io/Ark.jl/stable/assets/preview.png"/><meta property="twitter:card" content="summary_large_image"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/><link href="../assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../index.html"><img class="docs-light-only" src="../assets/logo.svg" alt="Ark.jl logo"/><img class="docs-dark-only" src="../assets/logo-dark.svg" alt="Ark.jl logo"/></a><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="quickstart.html">Quickstart</a></li><li><a class="tocitem" href="world.html">The World</a></li><li><a class="tocitem" href="entities.html">Entities</a></li><li><a class="tocitem" href="components.html">Components</a></li><li><a class="tocitem" href="queries.html">Queries</a></li><li><a class="tocitem" href="systems.html">Systems</a></li><li><a class="tocitem" href="resources.html">Resources</a></li><li class="is-active"><a class="tocitem" href="events.html">Event system</a><ul class="internal"><li><a class="tocitem" href="#Example"><span>Example</span></a></li><li><a class="tocitem" href="#Event-types"><span>Event types</span></a></li><li><a class="tocitem" href="#combining-types"><span>Combining multiple types</span></a></li><li><a class="tocitem" href="#Filters"><span>Filters</span></a></li><li><a class="tocitem" href="#Event-timing"><span>Event timing</span></a></li><li><a class="tocitem" href="#custom-events"><span>Custom events</span></a></li></ul></li><li><a class="tocitem" href="architecture.html">Architecture</a></li></ul></li><li><a class="tocitem" href="../demos.html">Demos</a></li><li><a class="tocitem" href="../benchmarks.html">Benchmarks</a></li><li><a class="tocitem" href="../api.html">Public API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href="events.html">Event system</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="events.html">Event system</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/mlange-42/Ark.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/mlange-42/Ark.jl/blob/main/docs/src/manual/events.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Event-system"><a class="docs-heading-anchor" href="#Event-system">Event system</a><a id="Event-system-1"></a><a class="docs-heading-anchor-permalink" href="#Event-system" title="Permalink"></a></h1><p>Ark provides an event system with observers that allow an application to react on events, such as adding and removing components and entities.</p><p>Observers can <a href="events.html#Filters">filter</a> for the events they are interested in, in several ways. A callback function is executed for the affected entity whenever an observer&#39;s filter matches.</p><p>In addition to built-in lifecycle events like <code>OnCreateEntity</code> or <code>OnAddComponents</code>, Ark supports <a href="events.html#custom-events">custom event types</a> that enable domain-specific triggers. These events can be emitted manually and observed with the same filtering and callback mechanisms, making them ideal for modeling interactions such as user input, synchronization, or game logic.</p><p>Observers are lightweight, composable, and follow the same declarative patterns as Ark’s <a href="queries.html#Queries">query</a> system. They provide fine-grained control over when and how logic is executed. This design encourages a declarative, data-driven approach while maintaining performance and flexibility.</p><h2 id="Example"><a class="docs-heading-anchor" href="#Example">Example</a><a id="Example-1"></a><a class="docs-heading-anchor-permalink" href="#Example" title="Permalink"></a></h2><p>Use <a href="../api.html#Ark.observe!">observe!</a> to observe for events:</p><pre><code class="language-julia hljs">observe!(world, OnAddComponents, (Position, Velocity)) do entity
    pos, vel = get_components(world, entity, (Position, Velocity))
    println(pos)
    println(vel)
end

entity = new_entity!(world, ())
add_components!(world, entity, (Position(0, 0), Velocity(1, 1)))</code></pre><h2 id="Event-types"><a class="docs-heading-anchor" href="#Event-types">Event types</a><a id="Event-types-1"></a><a class="docs-heading-anchor-permalink" href="#Event-types" title="Permalink"></a></h2><p>Observers are specific for different <a href="../api.html#Ark.EventType">event types</a>, and each observer can react only to one type. See <a href="events.html#combining-types">below</a> for how to react on multiple different types.</p><ul><li><strong><code>OnCreateEntity</code></strong>: Emitted after a new entity is created.  </li><li><strong><code>OnRemoveEntity</code></strong>: Emitted before an entity is removed.</li><li><strong><code>OnAddComponents</code></strong>: Emitted after components are added to an existing entity.</li><li><strong><code>OnRemoveComponents</code></strong>: Emitted before components are removed from an entity.</li></ul><p>If multiple components are added/removed for an entity, one event is emitted for the entire operation.</p><h2 id="combining-types"><a class="docs-heading-anchor" href="#combining-types">Combining multiple types</a><a id="combining-types-1"></a><a class="docs-heading-anchor-permalink" href="#combining-types" title="Permalink"></a></h2><p>Observers can be combined to react to multiple event types in a single callback function. Below is a combination of observers to react on component addition as well as removal. The callback is set up to be able to distinguish between these event types (if needed).</p><pre><code class="language-julia hljs">fn = (event::EventType, entity::Entity) -&gt; begin
    if event == OnAddComponents
        println(&quot;Position added&quot;)
    elseif event == OnRemoveComponents
        println(&quot;Position removed&quot;)
    end
end

observe!(world, OnAddComponents, (Position,)) do entity
    fn(OnAddComponents, entity)
end
observe!(world, OnRemoveComponents, (Position,)) do entity
    fn(OnRemoveComponents, entity)
end</code></pre><h2 id="Filters"><a class="docs-heading-anchor" href="#Filters">Filters</a><a id="Filters-1"></a><a class="docs-heading-anchor-permalink" href="#Filters" title="Permalink"></a></h2><p>Observers only trigger when all specified components (last non-keyword argument) are affected in a single operation. For example, if an observer watches <code>Position</code> and <code>Velocity</code>, both must be added or removed together for the observer to activate.</p><p>Further, events can be filtered by the composition of the affected entity via the keyword arguments <code>with</code>, <code>without</code> and <code>exclusive</code>, just like <a href="queries.html#Queries">queries</a>.</p><p>For entity creation and removal, only the keyword arguments can be used.</p><p><strong>Examples</strong> (leaving out observer registration):</p><p>An observer that is triggered when a <code>Position</code> component is added to an existing entity:</p><pre><code class="language-julia hljs">observe!(world, OnAddComponents, (Position,)) do entity
    # ...
end</code></pre><p>An observer that is triggered when a <code>Position</code> component is added to an entity that has <code>Velocity</code>, but not <code>Altitude</code> (or rather, had before the operation):</p><pre><code class="language-julia hljs">observe!(world, OnAddComponents, (Position,);
        with    = (Velocity,),
        without = (Altitude,)
    ) do entity
    # ...
end</code></pre><p>This observer is triggered when an entity with <code>Position</code> is created:</p><pre><code class="language-julia hljs">observe!(world, OnCreateEntity;
        with = (Velocity,)
    ) do entity
    # ...
end</code></pre><p>This observer is triggered when an entity with <code>Position</code> as well as <code>Velocity</code> is created:</p><pre><code class="language-julia hljs">observe!(world, OnCreateEntity;
        with = (Position, Velocity)
    ) do entity
    # ...
end</code></pre><p>An observer that is triggered when any entity is created, irrespective of its components:</p><pre><code class="language-julia hljs">observe!(world, OnCreateEntity) do entity
    # ...
end</code></pre><h2 id="Event-timing"><a class="docs-heading-anchor" href="#Event-timing">Event timing</a><a id="Event-timing-1"></a><a class="docs-heading-anchor-permalink" href="#Event-timing" title="Permalink"></a></h2><p>The time an event is emitted relative to the operation it is related to depends on the event&#39;s type. The observer callbacks are executed immediately by any emitted event.</p><p>Events for entity creation and for adding or setting components are emitted after the operation. Hence, the new or changed components can be inspected in the observer&#39;s callback. If emitted from individual operations, the world is in an <a href="queries.html#world-lock">unlocked</a> state when the callback is executed. Contrary, when emitted from a batch operation, the world is <a href="queries.html#world-lock">locked</a>.</p><p>Events for entity or component removal are emitted before the operation. This way, the entity or component to be removed can be inspected in the observer&#39;s callback. In this case, the world is <a href="queries.html#world-lock">locked</a> when the callback is executed.</p><p>Note that observer order is undefined. Observers are not necessarily triggered in the same order as they were registered.</p><h2 id="custom-events"><a class="docs-heading-anchor" href="#custom-events">Custom events</a><a id="custom-events-1"></a><a class="docs-heading-anchor-permalink" href="#custom-events" title="Permalink"></a></h2><p>Custom events in Ark allow developers to define and emit their own event types, enabling application-specific logic such as UI interactions, game state changes, or other domain-specific triggers. These events support the same filtering and observer mechanisms as built-in events.</p><p>Define custom event types using an <a href="../api.html#Ark.EventRegistry">EventRegistry</a> and <a href="../api.html#Ark.new_event_type!">new<em>event</em>type!</a>:</p><pre><code class="language-julia hljs"># Create an event registry
registry = EventRegistry()

# Create event types
const OnCollisionDetected = new_event_type!(registry, :OnCollisionDetected)
const OnInputReceived     = new_event_type!(registry, :OnInputReceived)
const OnLevelLoaded       = new_event_type!(registry, :OnLevelLoaded)
const OnTimerElapsed      = new_event_type!(registry, :OnTimerElapsed)</code></pre><p>Ideally, custom event types are stored as global variables of the applications.</p><p>Use <a href="../api.html#Ark.emit_event!">emit_event!</a> to emit custom events:</p><pre><code class="language-julia hljs">registry = EventRegistry()
const OnTeleport = new_event_type!(registry, :OnTeleport)

# Add an observer for the event type
observe!(world, OnTeleport, (Position,)) do entity
    # ...
end

# Emit the event for an entity and component type(s)
emit_event!(world, OnTeleport, entity, (Position,))</code></pre><p>Observers might not be interested in components, or in more than one component. This is also supported by custom events:</p><pre><code class="language-julia hljs">registry = EventRegistry()
const OnClick = new_event_type!(registry, :OnClick)

emit_event!(world, OnClick, ui_element)</code></pre><p>Note that custom events can also be emitted for the <a href="../api.html#Ark.zero_entity">zero entity</a>:</p><pre><code class="language-julia hljs">registry = EventRegistry()
const OnGameOver = new_event_type!(registry, :OnGameOver)

emit_event!(world, OnGameOver, zero_entity)</code></pre><p>For custom events, observer <a href="events.html#Filters">filters</a> work exactly the same as for predefined events. The components in the last (optional) non-keyword argument are matched against the components of the event. <code>with</code>, <code>without</code> and <code>exclusive</code> are matched against the entity for which the event is emitted.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="resources.html">« Resources</a><a class="docs-footer-nextpage" href="architecture.html">Architecture »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Wednesday 26 November 2025 13:21">Wednesday 26 November 2025</span>. Using Julia version 1.12.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
